// main global script file

// called when the game starts, before the first room is loaded


// called on every game cycle, except when the game is blocked
function repeatedly_execute()
{
  UpdatePlayerTarget();
}

// called on every game cycle, even when the game is blocked
function repeatedly_execute_always()
{
  
}

// called when a key is pressed
function on_key_press(eKeyCode keycode, int mod)
{
  if (IsGamePaused())
  {
    // game paused, so don't react to any keypresses
    keycode = 0;
  }
  else if (keycode == eKeyF4)
  {
    // Ctrl-Q will quit the game
    QuitGame(0);
  }
  else if (keycode == eKeyF9)
  {
    // F9 will restart the game
    RestartGame();
  }
  else if (keycode == eKeyF12)
  {
    // F12 will save a screenshot to the save game folder
    SaveScreenShot("screenshot.pcx");
  }
  else if (mod & eKeyModCtrl)
  {
    if (keycode == eKeyS)
    {
      // Ctrl-S will give the player all defined inventory items
      Debug(0, 0);
    }
    else if (keycode == eKeyV)
    {
      // Ctrl-V will show game engine version and build date
      Debug(1, 0);
    }
    else if (keycode == eKeyA)
    {
      // Ctrl-A will show walkable areas
      Debug(2, 3);
    }
    else if (keycode == eKeyX)
    {
      // Ctrl-X will let the player teleport to any room
      Debug(3, 0);
    }
  }
}

// called when a mouse button is clicked
function on_mouse_click(MouseButton button)
{
  if (IsGamePaused())
  {
    // game is paused, so do nothing (i.e. don't process mouse clicks)
  }
  else if (button == eMouseLeft)
  {
    if(!CanPlayerMove){return;}
    
    // left-click, so try using the current mouse cursor mode at this position
    Room.ProcessClick(mouse.x, mouse.y, mouse.Mode);
  }
  else if (button == eMouseRight)
  {
    if(!CanPlayerMove){return;}
    
    // right-click, so cycle the mouse cursor mode
    mouse.SelectNextMode();
  }
}

function dialog_request(int param) {
}
function gGui1_OnClick(GUI *theGui, MouseButton button)
{

}

function Enter_OnClick(GUIControl *control, MouseButton button)
{
  if( Contrasena.Text == "KINGER"){
    
    Contrasena.TextColor = 1638;
    Contrasena.Text = "Contraseña correcta" ;
    Wait(50);
    InputTeclado.Visible = false;
    InputTeclado.Clickable = false;   
    HavePomniKey = true ;
    StartDialogue(0 ,  "Oh , por fin puedo entrar a mi cuarto");
    EndDialogue(true);
    Wait(30);
    GameProgress = 1;
    cPlayer.ChangeRoom(2 ,  863 ,  267,  eDirectionDown);
    
    }else{
      
      Contrasena.TextColor = 63488;
      Contrasena.Text = "Contraseña incorrecta" ;
      Wait(80);
       Contrasena.TextColor = 0;
      Contrasena.Text = "" ;
      }
}


function Salir_OnClick(GUIControl *control, MouseButton button)
{
  ContrasenaInput = "";
 InputTeclado.Visible = false;
 InputTeclado.Clickable = false;
}

function Q_OnClick(GUIControl *control, MouseButton button)
{
  
  Contrasena.Text = Contrasena.Text.Append("Q");
}

function W_OnClick(GUIControl *control, MouseButton button)
{
  Contrasena.Text = Contrasena.Text.Append("W");
}

function E_OnClick(GUIControl *control, MouseButton button)
{
  Contrasena.Text = Contrasena.Text.Append("E");
}


function R_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("R");
}

function T_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("T");
}

function Y_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("Y");
}

function U_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("U");
}

function I_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("I");
}

function O_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("O");
}

function P_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("P");
}

function A_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("A");
}

function S_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("S");
}

function D_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("D");
}

function F_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("F");
}

function G_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("G");
}

function H_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("H");
}

function J_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("J");
}

function K_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("K");
}

function L_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("L");
}


function Z_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("Z");
}

function X_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("X");
}

function C_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("C");
}

function V_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("V");
}

function B_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("B");
}

function N_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("N");
}

function M_OnClick(GUIControl *control, MouseButton button)
{
Contrasena.Text = Contrasena.Text.Append("M");
}


function Volver_OnClick(GUIControl *control, MouseButton button)
{
   gHintSafeBox.Clickable = false;
   gHintSafeBox.Visible = false;
}

function npc_Jax_Look()
{
 StartDialogue(0 , "Es Jax, no me cae muy bien.");
 EndDialogue(true);
}

function npc_Jax_Talk()
{

 if(HelpedRagatha == true){
   MovePlayerAndWait(cJax.x -30,  cJax.y, eDirectionLeft);
   StartDialogue(2 , "¿Que hay de nuevo , vieja?");
   StartDialogue(0 , "¿Tu eras Jax,  no ?");
   StartDialogue(2 , "Puede ser ... ¿Que quieres?");
   StartDialogue(0 , "¿Me dijeron que tu tenías la llave de mi cuarto no?");
   StartDialogue(0 , "¿Podrías dármela?");
   StartDialogue(2 , "Ah sí , esta en mi cuarto.");
   StartDialogue(0 , "Podemos ir a por ella?");
   StartDialogue(2 , "No me gusta que la gente hurgue entre mis cosas");
   StartDialogue(2 , "Con lo cual , no te dejaré entrar.");
   StartDialogue(2 , "Ahora vete a llorar junto a Gangle , cada payaso necesita su careta de feria");
   StartDialogue(0 , "...");
   EndDialogue(true);
   AngryZooble = true;
   
   }else{
      MovePlayerAndWait(cJax.x -30,  cJax.y, eDirectionLeft);
     StartDialogue(2 , "Oye novata , ahora no estoy de humor , dejame algo de espacio...");
     StartDialogue(0 , "...");
     EndDialogue(true);
     
   }
}

function npc_Zooble_Look()
{
 StartDialogue(0 , "Son Zooble y Raghata.");
 EndDialogue(true);
}




function npc_Zooble_Talk()
{
  MovePlayerAndWait(cZooble.x + 40,  cZooble.y + 40 , eDirectionRight);
  
  if(AngryZooble == true){
    
    StartDialogue(5 , "¿Que tal , has conseguido algo?");
    StartDialogue(0 , "Me ha mandado a la ****** , hablando en plata.");
    StartDialogue(1 , "¡NO , NO , NO ,  RECORDAD QUE ESE LENGUAJE NO ESTA PERMITIDO!");
    StartDialogue(5 , "Vaya , pues que cabezón.");
    StartDialogue(5 , "Escucha, puedes usar mi mano a modo de ganzúa para abrir su puerta");
    StartDialogue(5 , "Date prisa , no me gusta ir sin brazo por el circo...");
    StartDialogue(0 , "¡Muchas gracias!");
    EndDialogue(true);
    BrazoZooble = true;
    
    }
  
  
  
 if(HelpedRagatha == true && AngryZooble == false){
   
    StartDialogue(5 , "Gracias por ayudar a mi amiga. ");
    StartDialogue(5 , "Te ayudaría ,  pero Jax a veces es muy cabezón ");
    StartDialogue(5 , "Tienes que pillar a Jax de buen humor para que te deje entrar a su cuarto , es muy reservado. ");
    StartDialogue(5 , "Pero es un buen tipo , aunque muy travieso");
    StartDialogue(5 , "Intenta mediar con el y convencerle, si no te deja, ven a hablar conmigo. ");
    EndDialogue(true);
   }
   
   if(RagathaIssue == 0 && HelpedRagatha == false){
  StartDialogue(6 , "SNIF, SNIF");
  StartDialogue(5 , "Tranquila, tranquila");
  StartDialogue(0 , "¿Ocurre algo?");
  StartDialogue(6 , "Lo tenía ... SNIF, en la cara ... SNIF,  y ahora no sé donde está ... ");
  StartDialogue(5 , "Ya pasó, lo que Ragatha quiere decir es que no encontramos su ojo, se le debió de caer en algun momento");
  StartDialogue(5 , "¿Podrias ayudarmos?");
  EndDialogue(true);
  
  if(cPlayer.Room == 1){
  object[6].Visible = true;
  object[6].Clickable = true;
  }
  
 // npc_Caine.Visible = false;    //cCaine.changeRoom(5);
 // npc_Caine.Clickable = false;  //cCaine.changeRoom(5);
  RagathaIssue = 1;
  } else if (RagathaIssue == 1 && HelpedRagatha == false){
    
  StartDialogue(6 , "¿Has encontrado algo para ayudarme?");
  StartDialogue(0 , "No , creo que no");
  StartDialogue(6 , "Pues debería haber algo por ahi...");
  StartDialogue(5 , "Estaremos por aqui cuando quieras hablar con nosotres");
  EndDialogue(true);
    
    
  }else if (RagathaIssue == 2 && HelpedRagatha == false && needle == true && EyeCollected == false){
    
  //  npc_Caine.Visible = false;
  //  npc_Caine.Clickable = false;
   StartDialogue(6 , "¿Has encontrado algo para ayudarme?");
   StartDialogue(0 , "Si ,  por ahi habia una aguja.");
   StartDialogue(5 , "Genial , con esto podemos coser el ojo.");
   StartDialogue(6 , "Ahora solo falta encontrarlo...");
   StartDialogue(0 , "¿Por qué no hablamos con Caine? A lo mejor sabe algo.");
   StartDialogue(5, "Me pareció verle entrar en la caseta del circo... No sé que estara tramando");
  EndDialogue(true);
    
  }else if (RagathaIssue == 2 && HelpedRagatha == false && needle == false && EyeCollected == true){
    
    StartDialogue(6 , "¿Has encontrado algo para ayudarme?");
    StartDialogue(0 , "¿Es este tu ojo?");
    StartDialogue(6 , "OH! LO HAS ENCONTRADO , MI OJO!");
    StartDialogue(5 , "Ahora solo necesitamos algo para coserlo otra vez");  
    EndDialogue(true);
    
    
    }else if (RagathaIssue == 2 && HelpedRagatha == false && needle == true && EyeCollected == true){
      
      StartDialogue(6 , "¿Has encontrado algo para ayudarme?");
      StartDialogue(0 , "Si ,  creo que ya tenemos lo que hace falta ...");
      StartDialogue(6 ,  "¡OH, GENIAL, MUCHAS GRACIAS!");
      StartDialogue(5 , "Espera , que te ayudo a cosértelo...");
      StartDialogue(6 , "...");
      StartDialogue(5 , "Mmm... Por aquí , por allá , ¡Ya está!");
      StartDialogue(6 , "¡Muchas gracias a las dos! ¡Os estoy muy agradecida");
      StartDialogue(0 , "No ha sido nada ");
      StartDialogue(5 , "Gracias novata , ven aqui que te voy a contar un secretillo ...");
      EndDialogue(true);
      HelpedRagatha = true;
    }
}

